<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 1906. Minimum Absolute Difference Queries | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 1906. Minimum Absolute Difference Queries" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-14T19:09:20+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 1906. Minimum Absolute Difference Queries" />
<script type="application/ld+json">
{"url":"/leetcode/1906.html","@type":"BlogPosting","headline":"Leetcode 1906. Minimum Absolute Difference Queries","dateModified":"2021-08-14T19:09:20+02:00","datePublished":"2021-08-14T19:09:20+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/1906.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/accumulate"><code class="highligher-rouge"><nobr>accumulate</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/hash table"><code class="highligher-rouge"><nobr>hash table</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/counter"><code class="highligher-rouge"><nobr>counter</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 1906. Minimum Absolute Difference Queries</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-14T19:09:20+02:00" itemprop="datePublished">
        Aug 14, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://leetcode.com/problems/minimum-absolute-difference-queries/"> <font color="blue">https://leetcode.com/problems/minimum-absolute-difference-queries/</font></a></p>

<h4 id="solution-1">Solution 1</h4>
<p>To solve this problem efficiently, we need to read problem constraints carefully and what we can notice, that all numbers are not so big, that is in range <code class="language-plaintext highlighter-rouge">1, N</code>, where <code class="language-plaintext highlighter-rouge">N &lt;= 100</code>. Let us consider cumulative sums, or you can call it cumulative counters of our numbers. Let us consider example <code class="language-plaintext highlighter-rouge">nums = [4, 5, 2, 2, 7, 10]</code>, then we have:</p>

<p><code class="language-plaintext highlighter-rouge">dp[0] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[1] = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[2] = [0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[3] = [0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[4] = [0, 0, 2, 0, 1, 1, 0, 0, 0, 0, 0]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[5] = [0, 0, 2, 0, 1, 1, 0, 1, 0, 0, 0]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[6] = [0, 0, 2, 0, 1, 1, 0, 1, 0, 0, 1]</code></p>

<p>On the first step we have no elements, so frequencies of every element is equal to zero. Then we added <code class="language-plaintext highlighter-rouge">4</code>, and we increase <code class="language-plaintext highlighter-rouge">4</code>-th place by one and so on. Why we need these <code class="language-plaintext highlighter-rouge">dp</code> table? Of course for fast evaluation of queries. How we can evaluate query now? For example to evaluate query for interval <code class="language-plaintext highlighter-rouge">[1, 5]</code> what we need to do is look at <code class="language-plaintext highlighter-rouge">dp[6]</code> and <code class="language-plaintext highlighter-rouge">dp[1]</code> and choose only indexes of those elements which have different frequencies. For given example we have</p>

<p><code class="language-plaintext highlighter-rouge">dp[6] = [0, 0, 2, 0, 1, 1, 0, 1, 0, 0, 1]</code></p>

<p><code class="language-plaintext highlighter-rouge">dp[1] = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]</code></p>

<p>So, we look at indexes <code class="language-plaintext highlighter-rouge">2, 5, 7, 10</code> and then choose minimum among gaps, which is equal to <code class="language-plaintext highlighter-rouge">2</code>.</p>

<h4 id="complexity">Complexity</h4>
<p>Time complexity of evaluation of cumulative sums is <code class="language-plaintext highlighter-rouge">O(N*n)</code>, where <code class="language-plaintext highlighter-rouge">N</code> is the biggest number among <code class="language-plaintext highlighter-rouge">nums</code> and <code class="language-plaintext highlighter-rouge">n</code> is length of <code class="language-plaintext highlighter-rouge">nums</code>. Then we have <code class="language-plaintext highlighter-rouge">Q</code> queries, each of which can be evaluated in <code class="language-plaintext highlighter-rouge">O(N)</code>. So, total time complexity is <code class="language-plaintext highlighter-rouge">O(N*(n+Q)</code>, which is no more than <code class="language-plaintext highlighter-rouge">10^7</code> given problem constraints. Also simple list operations work quite fast in python, but we can make it faster, if we use numpy (<strong>TBD</strong>). Space complexity is <code class="language-plaintext highlighter-rouge">O(N*n)</code>.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">minDifference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">,</span> <span class="n">queries</span><span class="p">):</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">ans</span><span class="p">,</span> <span class="n">dp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nums</span><span class="p">),</span> <span class="p">[],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:]</span>
            <span class="n">t</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">dp</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="n">y</span> <span class="o">!=</span> <span class="n">x</span><span class="p">]</span>
            <span class="n">ans</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">([</span><span class="n">b</span><span class="o">-</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span> <span class="ow">or</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        
        <span class="k">return</span> <span class="n">ans</span>
</code></pre></div></div>

<h4 id="solution-2">Solution 2</h4>
<p>Here we use exaclty the same logic, but use numpy functionality. I was hoping that it will work much faster, but in fact it is not much faster due to implicit use of loops. Here I use couple of tricks: first one when we evaluate <code class="language-plaintext highlighter-rouge">dp</code>, I do it with cumulative function and with unity matrix trick. Then we use nonzero and diff functions.</p>

<h4 id="complexity-1">Complexity</h4>
<p>It is the same we have as in the first solution 1. Potentially it can work faster due to optimized numpy library, but the problem here that np.nonzero() will give different length answer for each row and I do not know how to avoid implicit loops here and go fully numpy. If you know, plese <strong>let me know in comments</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">minDifference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">diff</span><span class="p">((</span><span class="n">dp</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="n">dp</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]).</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
</code></pre></div></div>

  </div><a class="u-url" href="/leetcode/1906.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>