<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 1337. The K Weakest Rows in a Matrix | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 1337. The K Weakest Rows in a Matrix" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="https://leetcode.com/problems/the-k-weakest-rows-in-a-matrix" />
<meta property="og:description" content="https://leetcode.com/problems/the-k-weakest-rows-in-a-matrix" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-14T19:09:20+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 1337. The K Weakest Rows in a Matrix" />
<script type="application/ld+json">
{"url":"/leetcode/1337.html","@type":"BlogPosting","headline":"Leetcode 1337. The K Weakest Rows in a Matrix","dateModified":"2021-08-14T19:09:20+02:00","datePublished":"2021-08-14T19:09:20+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/1337.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"https://leetcode.com/problems/the-k-weakest-rows-in-a-matrix","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/bucket sort"><code class="highligher-rouge"><nobr>bucket sort</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/binary search"><code class="highligher-rouge"><nobr>binary search</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 1337. The K Weakest Rows in a Matrix</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-14T19:09:20+02:00" itemprop="datePublished">
        Aug 14, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="https://leetcode.com/problems/the-k-weakest-rows-in-a-matrix"> <font color="blue">https://leetcode.com/problems/the-k-weakest-rows-in-a-matrix</font></a></p>

<p>What we can do is to count number of ones in each row and then sort all rows, using key with two elements: <code class="language-plaintext highlighter-rouge">(sum(row), ind)</code>, because if we have two rows with equal number of ones, we need to choose the one with smallest index.</p>

<p><strong>Complexity</strong>: time complexity is <code class="language-plaintext highlighter-rouge">O(mn)</code> to evaluate all sums and <code class="language-plaintext highlighter-rouge">O(m*log m)</code> to perform sort and choose <code class="language-plaintext highlighter-rouge">k</code> smallest elements, so final complexity is <code class="language-plaintext highlighter-rouge">O(mn + m log m)</code>. Space complexity is <code class="language-plaintext highlighter-rouge">O(m)</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">kWeakestRows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">([(</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">ind</span><span class="p">)</span> <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mat</span><span class="p">)])[:</span><span class="n">k</span><span class="p">]]</span>
</code></pre></div></div>

<h3 id="buckets-solution">Buckets solution</h3>

<p>This problem is marked as easy on leetcode, because dimensions of problem is quite small and given solution will be fast enough. However we did not use some information given in problem statement, so we can improve our performance:</p>
<ol>
  <li>First of all, in each row data is sorted, like <code class="language-plaintext highlighter-rouge">[1, 1, 1, ..., 0, 0, 0]</code>, and we do not really need to traverse all list to find how many ones we have inside, and we can do binary search instead with complexity <code class="language-plaintext highlighter-rouge">O(log n)</code>, so complexity of first step will be <code class="language-plaintext highlighter-rouge">O(m log n)</code> instead of <code class="language-plaintext highlighter-rouge">O(mn)</code>. Unfortunatelly you can not use bisect library here, because data in rows sorted in reverse order and you need to do it by hands.</li>
  <li>Secondly, we do not need to sort all data, but we only need to choose <code class="language-plaintext highlighter-rouge">k</code> smallest elements, which can be done, using heaps: we can keep heap with <code class="language-plaintext highlighter-rouge">k</code> elements and have complexity <code class="language-plaintext highlighter-rouge">O(m log k)</code>. Moreover, because frequencies will not be more than <code class="language-plaintext highlighter-rouge">n</code>, we can use bucket sort to find <code class="language-plaintext highlighter-rouge">k</code> smallest values.</li>
</ol>

<p>Final time complexity will be <code class="language-plaintext highlighter-rouge">O(m log n + n)</code>, space complexity is <code class="language-plaintext highlighter-rouge">O(n)</code>. If <code class="language-plaintext highlighter-rouge">m log k &lt;&lt; n</code>, it is more preferable to use heaps, however even though complexity of heap operations is <code class="language-plaintext highlighter-rouge">O(log k)</code>, constant is quite big, so I can say, bucket sort is preferable.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">kWeakestRows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">num_ones</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
            <span class="n">beg</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span>
            <span class="k">while</span> <span class="n">beg</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
                <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">beg</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
                <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> 
                    <span class="n">beg</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="n">end</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="k">return</span> <span class="n">beg</span>
        
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">buckets</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
            <span class="n">buckets</span><span class="p">[</span><span class="n">num_ones</span><span class="p">(</span><span class="n">row</span><span class="p">)].</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">buckets</span><span class="p">))[:</span><span class="n">k</span><span class="p">]</span>
</code></pre></div></div>

<p>If you like the solution, you can <strong>upvote</strong> it on leetcode discussion section:<a href="https://leetcode.com/problems/the-k-weakest-rows-in-a-matrix/discuss/1066593/python-oneliner-explained-%2b-discussion"> <font color="blue">Problem 1337</font></a></p>

  </div><a class="u-url" href="/leetcode/1337.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>