<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 0399. Evaluate Division | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 0399. Evaluate Division" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="https://leetcode.com/problems/evaluate-division" />
<meta property="og:description" content="https://leetcode.com/problems/evaluate-division" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-14T19:09:20+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 0399. Evaluate Division" />
<script type="application/ld+json">
{"url":"/leetcode/0399.html","@type":"BlogPosting","headline":"Leetcode 0399. Evaluate Division","dateModified":"2021-08-14T19:09:20+02:00","datePublished":"2021-08-14T19:09:20+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/0399.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"https://leetcode.com/problems/evaluate-division","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/graph"><code class="highligher-rouge"><nobr>graph</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/dfs"><code class="highligher-rouge"><nobr>dfs</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/union find"><code class="highligher-rouge"><nobr>union find</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 0399. Evaluate Division</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-14T19:09:20+02:00" itemprop="datePublished">
        Aug 14, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="https://leetcode.com/problems/evaluate-division"> <font color="blue">https://leetcode.com/problems/evaluate-division</font></a></p>

<p>First of all, if we look carefully at this problem we can see, that it is graph problem: let our variables be nodes and divistions be connections. It is also given, that there is no contradictions in this graph and divisions by zero, so we do not need to think about it. Let us use <code class="language-plaintext highlighter-rouge">dfs(start, comp, w)</code> function, with parameters:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">start</code> is current node(variable) we visit</li>
  <li><code class="language-plaintext highlighter-rouge">comp</code> number of connected component: imagine we have <code class="language-plaintext highlighter-rouge">x/y = 4, y/z = 3</code> and <code class="language-plaintext highlighter-rouge">a/b = 2</code>, then first component is <code class="language-plaintext highlighter-rouge">(x,y,z)</code> and second is <code class="language-plaintext highlighter-rouge">(a,b)</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">w</code> is current weight or value of our node: imagine that we start with node <code class="language-plaintext highlighter-rouge">x</code>, then we have weight for <code class="language-plaintext highlighter-rouge">x = 1</code>, weight for <code class="language-plaintext highlighter-rouge">y = 1/4</code> and weight for <code class="language-plaintext highlighter-rouge">z = 1/12</code>.</li>
</ol>

<p>So, what <code class="language-plaintext highlighter-rouge">dfs</code> function will do? for given <code class="language-plaintext highlighter-rouge">start</code> value it traverse our graph and check if <code class="language-plaintext highlighter-rouge">self.w[j][0] = -1</code>. We define <code class="language-plaintext highlighter-rouge">for var in varbs: self.w[var] = [-1,-1]</code> in the beginning: first value is responsible for number of connected component and second number is responsible for weight. So, if we have neighbour, which is not visited yet, we run <code class="language-plaintext highlighter-rouge">dfs</code> recursively.</p>

<p>Main function: first we grab the names of all variables (nodes), using <code class="language-plaintext highlighter-rouge">varbs = set(chain(*equations))</code>, then we create defaultdict of edges: for every equation we add two connections: one for direct and one for inversed. Next we iterate over all variables and run <code class="language-plaintext highlighter-rouge">dfs</code> if this variable(node) is not visited yet.
Finally, we traverse <code class="language-plaintext highlighter-rouge">queries</code> and we found that one of the variables is not in <code class="language-plaintext highlighter-rouge">varbs</code> or they both are, but they are in two different connected components, we return <code class="language-plaintext highlighter-rouge">-1</code>. If it is not the case, we return division of weights.</p>

<p><strong>Complexity</strong>: Time complexity is <code class="language-plaintext highlighter-rouge">O(E+V+Q)</code>, where <code class="language-plaintext highlighter-rouge">V</code> is number of variables (nodes), <code class="language-plaintext highlighter-rouge">E</code> is number of equations (edges) and <code class="language-plaintext highlighter-rouge">Q</code> is number of queries, because complexity of dfs is <code class="language-plaintext highlighter-rouge">O(E+V)</code> and we also have <code class="language-plaintext highlighter-rouge">Q</code> queries. Space complexity is also <code class="language-plaintext highlighter-rouge">O(E+V+Q)</code> to keep all nodes, edges and answers for queries.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">comp</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">edges</span><span class="p">[</span><span class="n">start</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">dfs</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="n">weight</span><span class="p">)</span>
      
    <span class="k">def</span> <span class="nf">calcEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">equations</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">queries</span><span class="p">):</span>
        <span class="n">varbs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">equations</span><span class="p">))</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">it</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">equations</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">it</span><span class="p">]])</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">edges</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">values</span><span class="p">[</span><span class="n">it</span><span class="p">]])</span>
            
        <span class="bp">self</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">varbs</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">varbs</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">dfs</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
                
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">varbs</span> <span class="ow">or</span> <span class="n">b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">varbs</span> <span class="ow">or</span> <span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">[</span><span class="n">b</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></div>

<p>If you like the solution, you can <strong>upvote</strong> it on leetcode discussion section:<a href="https://leetcode.com/problems/evaluate-division/discuss/867030/python-dfs-o(v%2be)-explained"> <font color="blue">Problem 0399</font></a></p>

  </div><a class="u-url" href="/leetcode/0399.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>