<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 1172. Dinner Plate Stacks | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 1172. Dinner Plate Stacks" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-14T19:09:20+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 1172. Dinner Plate Stacks" />
<script type="application/ld+json">
{"url":"/leetcode/1172.html","@type":"BlogPosting","headline":"Leetcode 1172. Dinner Plate Stacks","dateModified":"2021-08-14T19:09:20+02:00","datePublished":"2021-08-14T19:09:20+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/1172.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/design"><code class="highligher-rouge"><nobr>design</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/heap"><code class="highligher-rouge"><nobr>heap</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/bst"><code class="highligher-rouge"><nobr>bst</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/hash table"><code class="highligher-rouge"><nobr>hash table</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 1172. Dinner Plate Stacks</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-14T19:09:20+02:00" itemprop="datePublished">
        Aug 14, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://leetcode.com/problems/dinner-plate-stacks/"> <font color="blue">https://leetcode.com/problems/dinner-plate-stacks/</font></a></p>

<h4 id="solution-1">Solution 1</h4>
<p>The idea is to keep stack of plates <code class="language-plaintext highlighter-rouge">self.stack</code> and <code class="language-plaintext highlighter-rouge">self.S</code> is sorted list of pairs <code class="language-plaintext highlighter-rouge">(ind, size)</code> of not-full plates.</p>

<p>Then when we push we need to check:</p>

<ol>
  <li>If we have empty <code class="language-plaintext highlighter-rouge">self.S</code>, it means that all stack are full, so we need to create new one, add it.</li>
  <li>If it is not empty, take the smallest element from <code class="language-plaintext highlighter-rouge">self.S</code>: pair <code class="language-plaintext highlighter-rouge">(ind, sz)</code>.</li>
  <li>If after adding new element to this stack it is not full, we update information in <code class="language-plaintext highlighter-rouge">self.S</code>.</li>
  <li>Finally, add this plate to <code class="language-plaintext highlighter-rouge">self.plates</code>.</li>
</ol>

<p>When we want to perform <code class="language-plaintext highlighter-rouge">pop</code>, we:</p>

<ol>
  <li>First, remove all empty stacks from the end and if we do not have anything in the end, we return <code class="language-plaintext highlighter-rouge">-1</code>.</li>
  <li>Now, we know that the stack we want to work with is the last on in <code class="language-plaintext highlighter-rouge">self.plates</code>, so we update info.</li>
</ol>

<p>Update is auxiliary function, which given index and size of stack from which we pop, update <code class="language-plaintext highlighter-rouge">self.plates</code> and <code class="language-plaintext highlighter-rouge">self.S</code>: if capacity was not full, we remove old information from <code class="language-plaintext highlighter-rouge">self.S</code> (if it was full, it was not there) and then we add new info. Also update <code class="language-plaintext highlighter-rouge">self.plates</code>.</p>

<p>Finally, <code class="language-plaintext highlighter-rouge">popAtStack</code> function will work like this:</p>
<ol>
  <li>If <code class="language-plaintext highlighter-rouge">ind</code> is more than length of <code class="language-plaintext highlighter-rouge">self.plates</code> or stack is empty, return -1.</li>
  <li>If it is not empty, use <code class="language-plaintext highlighter-rouge">update</code> function.</li>
</ol>

<h4 id="complexity">Complexity</h4>
<p>Time complexity of all operations is <code class="language-plaintext highlighter-rouge">O(log n)</code>.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sortedcontainers</span> <span class="kn">import</span> <span class="n">SortedList</span>

<span class="k">class</span> <span class="nc">DinnerPlates</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cap</span> <span class="o">=</span> <span class="n">capacity</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">plates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S</span> <span class="o">=</span> <span class="n">SortedList</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ind</span><span class="p">,</span> <span class="n">sz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">),</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span><span class="p">,</span> <span class="n">sz</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">sz</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">cap</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">.</span><span class="n">add</span><span class="p">((</span><span class="n">ind</span><span class="p">,</span> <span class="n">sz</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="n">ind</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">sz</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">cap</span> <span class="o">!=</span> <span class="n">sz</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">.</span><span class="n">remove</span><span class="p">((</span><span class="n">ind</span><span class="p">,</span> <span class="n">sz</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">.</span><span class="n">add</span><span class="p">((</span><span class="n">ind</span><span class="p">,</span> <span class="n">sz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="n">ind</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        
        <span class="n">ind</span><span class="p">,</span> <span class="n">sz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">popAtStack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ind</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">sz</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="solution-2">Solution 2</h4>
<p>There is better approach using heaps: idea is similar, but now what we keep in heap is places which are available. Also we can have several equal elements in heap.</p>

<ol>
  <li>When we push new element and if we do not have places, we put <code class="language-plaintext highlighter-rouge">val</code> and create <code class="language-plaintext highlighter-rouge">self.c - 1</code> empty places. If we have places, we check if they are in existing stack, if they are not (it can happen that we made some stack fully empty) in this case we need to start new stack and add val.</li>
  <li>When we <code class="language-plaintext highlighter-rouge">pop</code> element first we remove last empty stacks. Then we add one more vacant place in this stack and return popped element.</li>
  <li>Finally, <code class="language-plaintext highlighter-rouge">popAtStack</code>: we check if our index is more than length of plates or stack in empty, in this case we return -1. Then we extract res, add one more vacant place and return <code class="language-plaintext highlighter-rouge">res</code>.</li>
</ol>

<h4 id="complexity-1">Complexity</h4>
<p>Time complexity for push is <code class="language-plaintext highlighter-rouge">O(log n)</code> for other two is <code class="language-plaintext highlighter-rouge">O(1)</code>.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DinnerPlates</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">plates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">capacity</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">emp</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">plates</span> <span class="o">+=</span> <span class="p">[[</span><span class="n">val</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span> <span class="n">heappush</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span>
            
        <span class="n">ind</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">):</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span> <span class="o">+=</span> <span class="p">[[]]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">val</span><span class="p">]</span>
       

    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">popAtStack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">heapq</span><span class="p">.</span><span class="n">heappush</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">plates</span><span class="p">[</span><span class="n">ind</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>
</code></pre></div></div>

  </div><a class="u-url" href="/leetcode/1172.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>