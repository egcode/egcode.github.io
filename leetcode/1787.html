<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 1787. Make the XOR of All Segments Equal to Zero | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 1787. Make the XOR of All Segments Equal to Zero" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notice, that the problem is equivalent to the following problem: we need to make a_0 = a_k = a_2k, a_1 = a_(k+1) = and so on. We can reformulate it: we have k groups of numbers and we need to change minimum possible number of numbers, such that in each group we have equal numbers and XOR of all groups is equal to 0." />
<meta property="og:description" content="Notice, that the problem is equivalent to the following problem: we need to make a_0 = a_k = a_2k, a_1 = a_(k+1) = and so on. We can reformulate it: we have k groups of numbers and we need to change minimum possible number of numbers, such that in each group we have equal numbers and XOR of all groups is equal to 0." />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-14T19:09:20+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 1787. Make the XOR of All Segments Equal to Zero" />
<script type="application/ld+json">
{"url":"/leetcode/1787.html","@type":"BlogPosting","headline":"Leetcode 1787. Make the XOR of All Segments Equal to Zero","dateModified":"2021-08-14T19:09:20+02:00","datePublished":"2021-08-14T19:09:20+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/1787.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Notice, that the problem is equivalent to the following problem: we need to make a_0 = a_k = a_2k, a_1 = a_(k+1) = and so on. We can reformulate it: we have k groups of numbers and we need to change minimum possible number of numbers, such that in each group we have equal numbers and XOR of all groups is equal to 0.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/bit-dp"><code class="highligher-rouge"><nobr>bit-dp</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 1787. Make the XOR of All Segments Equal to Zero</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-08-14T19:09:20+02:00" itemprop="datePublished">
        Aug 14, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Notice, that the problem is equivalent to the following problem: we need to make <code class="language-plaintext highlighter-rouge">a_0 = a_k = a_2k</code>, <code class="language-plaintext highlighter-rouge">a_1 = a_(k+1) = </code> and so on. We can reformulate it: we have <code class="language-plaintext highlighter-rouge">k</code> groups of numbers and we need to change minimum possible number of numbers, such that in each group we have equal numbers and <code class="language-plaintext highlighter-rouge">XOR</code> of all groups is equal to <code class="language-plaintext highlighter-rouge">0</code>.</p>

<p>Define as <code class="language-plaintext highlighter-rouge">dp[i][mask]</code> the maximum number of values we can <strong>not change</strong>, such that we have <code class="language-plaintext highlighter-rouge">mask</code> is XOR of first <code class="language-plaintext highlighter-rouge">i</code> groups (it is easier to work with maximums, not minimums, because groups can have different size).</p>

<p>Then, let us calculate <code class="language-plaintext highlighter-rouge">i</code>-th row of matrix <code class="language-plaintext highlighter-rouge">dp</code>, if we know <code class="language-plaintext highlighter-rouge">i-1</code>-th row. Then we can have two options:</p>

<ol>
  <li>On the last step we take <code class="language-plaintext highlighter-rouge">mask</code>, which is not in numbers of <code class="language-plaintext highlighter-rouge">dp[i-1]</code> row, it this case we need to choose maximum from <code class="language-plaintext highlighter-rouge">dp[i-1]</code></li>
  <li>Or we can take <code class="language-plaintext highlighter-rouge">mask</code>, which is inside group <code class="language-plaintext highlighter-rouge">i-1</code> of our numbers, in this case we need to check <code class="language-plaintext highlighter-rouge">dp[i-1][j^mask] + freq[i-1][mask]</code>.</li>
</ol>

<p><strong>Complexity</strong>: denote by <code class="language-plaintext highlighter-rouge">T</code> number of bits each number can be restricted and by <code class="language-plaintext highlighter-rouge">n</code> length of <code class="language-plaintext highlighter-rouge">nums</code>. We have <code class="language-plaintext highlighter-rouge">3</code> loops here, but loop for <code class="language-plaintext highlighter-rouge">i</code> and for <code class="language-plaintext highlighter-rouge">mask</code> will give you in total <code class="language-plaintext highlighter-rouge">O(n)</code> complexity, and loop for <code class="language-plaintext highlighter-rouge">j</code> will give you <code class="language-plaintext highlighter-rouge">O(2^T)</code> complexity, so totally we have <code class="language-plaintext highlighter-rouge">O(2^T n)</code> time complexity and <code class="language-plaintext highlighter-rouge">O(2^T  k)</code> space complexity.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">minChanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">10</span>
        
        <span class="n">freq</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
            <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="n">k</span><span class="p">][</span><span class="n">num</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            
        <span class="n">dp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span> <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">max_row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">max_row</span><span class="p">,</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">^</span><span class="n">mask</span><span class="p">]</span> <span class="o">+</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">mask</span><span class="p">])</span>
            
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="n">dp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="shorter-version-using-greedy-idea">Shorter version, using greedy idea</h3>

<p>This solution is inspired by <strong>delphih</strong> solution https://leetcode.com/problems/make-the-xor-of-all-segments-equal-to-zero/discuss/1097266/Python-Solution-with-some-explanation, please go and upvote this post!</p>

<p>First of all, it can be proven, that one of the two cases holds:</p>
<ol>
  <li>All numbers except one in each group are numbers from this groups.</li>
  <li>All numbers in each group are numbers from this group.</li>
</ol>

<p>It can be proven, that it can not happen, that we have <code class="language-plaintext highlighter-rouge">2</code> or more numbers from outside groups, I will write it a later if I have time.</p>

<p>For the first one, we need to check groups with the maximum frequencies of elements and choose the <code class="language-plaintext highlighter-rouge">k-1</code> most frequent.</p>

<p>For the second case, we can use almost the same logic we have previously, but now we do not need to think about numbers outside groups! So we just have case <code class="language-plaintext highlighter-rouge">1</code> from previous algorithm and we can forget about case <code class="language-plaintext highlighter-rouge">2</code>.</p>

<p><strong>Complexity</strong>: what is important, complexity is the same as it was previously: <code class="language-plaintext highlighter-rouge">O(2^T n)</code> time complexity and <code class="language-plaintext highlighter-rouge">O(2^T  k)</code> space complexity.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">minChanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="p">[</span><span class="n">Counter</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>
        <span class="n">mxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>

        <span class="o">@</span><span class="n">lru_cache</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">dp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">10000</span><span class="o">*</span><span class="n">j</span>  
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">dp</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">^</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">mxs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">mxs</span><span class="p">),</span> <span class="n">dp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>


  </div><a class="u-url" href="/leetcode/1787.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>